const hardPuzzlesString = "300200070061008020008400000000700350030010290902036000003000008507009610100000900;250400000300000054100000006000803009030000040090570020001030690003005082020069010;500081607000500900097060200001056000000000870004000000000308502200040760700002103;008009000502700090300040000000600054250007130091800000020004010800902700600000049;028010703006040000000008000280500104000800200640002000907000501100309020002071000;860309000000820090004050083158000000009000002000703005620001900907005004081000000;000070024000409050000100800080040912100000003090500070620000005070000061340080090;000290050010085090080000004000002410094600007000800060001000300003469000005100982;260104508500608070010000000003080006057030080180007000020800090001000050000590000;050080009601900020700002100000240703000030000000500962000004007000003054029070306;007501984080007000435020000001006000203010000000000608000000070000900540000075003;300100460068004093010000000050240000690080300204000006006000050005030748000002000;310900507004705036000300000000004002030090000000600070760030010083010000500020700;800005030900810004617090000080500200070001008560700003150020090000000000000040007;300400000910000007050070091046000800100000263008600000670098100000000030409032000;800004000207000000604500279000310900300900108079002000000600030050001600708000400;040009003030001006000037500096000300020000870071000042000080060008100405400920000;600050000500100300407000098100000900038000000006301007000004839000028010070906420;620000000009003000100680000507009300090000020010475000070024800045700090000098050;059012000000350020080090017004000208005680300000903000300000000508000740400005031;008000000600050170020006034201600000004027906050000000000705002865200090400900008;000002006007006150043000009005008010000000000000740605400001800020980507008054060;700900500300500210805000437010000790003287000000000600600100302000002000230050040;200605090000070500060009803090050032008000604057060000640030000900000008003002000;000400608000006005780009300060103020070908006300060700000890012900000000508000007;060000900070020000810090030000305081300000072007800000701008300026009708000760000;805320000000000007204608500009065300000240005000009000000970080980000030407003002;100400059040300001830010007060803705400002030000900000580030070000000210010007008;008032000100759060000000000000000340007064001040820090086300019000140007005006008;200400096800006002003005000920800001037900260100073900509030400040000020000000500;054068000800920050000450000005010900700300000480000006060002014008030007003107600;380605402000030650000001003940000000000048009070010000020079005000860390000400006;050000009001060004040000360000004800000100045007520001500700006204036000076050410;007009003000000890009260010470020000063504001001030060000000005084796100000000046;000801200800000419100020060508300000070000520200000073020085007001000004760900080;050008000069070010000009400003005290000100836000360050900230000005001040700000021;045060070903007680070200004004000029000000700587300000050041090009002000002690000;090048006070590000001000407007000064010804200405010003700060000002000009340002050;039000710000000000800007240010000509607510080000083620000091000106420800205000000;003007002007040001400026750008004007000009210700080000000002030006975800040600009;010700098900001004000983200520400801000268000080000400000300000040002607001050000;030450700002003040409000000000700100060000000000068030315002009087905004090006080;000000300800000900003274500706005010050000002400300608600040200500136000309000000;080000000700020430000946000001002008003400010850317200000000040037000890140700003;000001600020005030903000500800500000034000000760423190400017020050000000170902060;000420010008017000005800003001040530029700006004000800582000000097000000400000020;000040001020607300000012976060000007800030020700580010070400100581000060000000038;630004200020631700500000900070050312001040600000020004000000000140270000700000096;610000040407800001000200605005070000300108060020400008560003100000040306000900000;200008403043200000980000100007009006601800000000051000002043809090000250000790000;000000000000734095004000020609023000000800000208591403120000080000070500005080106;006004801100700290040000306000000900900051680783000005301900700060000000070020010;001205000092173050400000700600900000003050001050020800010300008040009007078000306;501007006002060000600000000009400010000009030080050094100805060000302081030001279;006093100000051090000800002093020470600007310000000900300008000210000040000700860;306100400000240000002060500000600000500070010039802007700900250610400000020507100;050009064000020570000045103000070406703608000000500700070000300095000601100003020;000206500100800060069000030800320000000000010700140800502700680607000005014000307;070900410002004080000000700400005300000240060903600000041826090200001000000000003;000400806040000070061700340600000580090120000004560000200800003000005700008904200;060705080000000004813460000608000000342080001700930000000003009005690000100000648;500300080007000001009008200090230060000005003453000090000000000002014900308702006;009007004048613000005480760000704005050000100870000432500800000100900000000000501;003004000200300900006900003070100009000000506068070010004002108900051020000406035;010000005003600092004000310000009008030800000090700050800040600047005901061902500;000005073100970002075200004209604000030010200708002000540000300000306007020000009;200050001009000205030009000540360000010040500000000603960800000001030064004005078;000000769010700000500000002000800901120050034980004000000200000700690400462007105;000460000020008500469000030000000009035040000804100050000609070000234690008005002;753100000609400200800000000000005102562000007070600809006001900080040305000300000;003000000000809500000306407091708004040090873000000005000910006002003700004070120;050000000600020401402076050890003002004007080000008900010002000207430006900000208;007900100000800070060740800000607082000452000000000009150083060093000250780000001;500608004601000000092050103050080000200000798007000300030800006000003200024105800;010409020605020000029500060400200600080000040002030700004001800500300409097000030;004200050006950800000000009102409000000506030950000000000100387089705000470020090;835401020900530010700090005020005760004000030000003190006000000000172000010059000;370058090004203100089004065508407000000030000000500000006005900807000006000710008;000000003000002865600807001000980200900000570801600030700064000004020000003100000;000070800907406350060093002200000493000000100753040006070010600300900000000200008;500080900900006005216509800002030000060000040408000070000600584620008000009007600;283400070090070000075002004500010000000000003610200807002000508009008340050009060;000000080090408600000300750802000040340521006001009003106005000080007005007090008;800000010020050970600004300000005700012098005000100000130407200200080090500901400;700030010200091004000000253060500370027300008008024000000000900300080400009000107;006001003080400000010000849008000031002083060400960020100000600007008050004710002;001500690800002740600090205007300100009008004010005900003006450000000009008900006;000800704000000002024007905000080076200073508580400000030000090002300800018209000;090100007260708009003000040035070090004000570607000800050200001000035020040010080;000063072930000800500000030008020001003040729062009480200051000000200040000800000;806300000400000700000607000057902000000105620000470000580000400004806310200001800;000250010420901708009000200008100005000083001670000403700000000000300802304000590;059800320042000001600590700420700008005900000000000005000000000268153009000040160;800004017000580406000020000009000604070360591000000300007900065060010000300070900;836001000002040370000000800020006107000000005000400090007900500900000700450872630;000807000000219078050030000020040700903006040100000020582071600000000352040000000;070050000090608400020000030041090607063000850007060000610000208050940000000002900;006000005042000030059030410063205000000000609480007020000000008700590000000128040;000000001084913070020500400000007020001000003250008907710060050008450000500309000;000000000076090051800050000300871000000040100910300000602010470001500800053007200;704600000030020604000300000602705400090001060400906300001003000026000800000802790;000031400089000510010000072500000000032009000046050000008302000103840005604170000;100060300005000670700310000406030050001000030059000000200000084000009012500108063;000500286000800053650200000003612000067080000020090800000020005810000000074060900;040600900500000320000008705900060000406002500810400000080000090090780150005004607;000030945000040002849000010070000001900200500002064380307000090000075104000080000;409000750001050096007060012004390020003000069080000500008000000300208900090000003;200540010600080002018000006000000000394020807000000091000730009580200000400000003;239000000108000094004000010080300900301000080000075600025009047400060320000700100;640097080000200901190036002030009000004000007020348000010000070070900004400060800;000340090800057000002000010019006230000700000500020461060070000100038900005090670;800000040027080000000000805010000002090000004040196308080301000009540100261000000;600000000005009000000500206960050034042000080007000000410000009020091005539002400;000060430004001000105000002000070500050900700067050320000400009000025000500030847;000005860050000009006930010120059000400800020003100000071000003030000006690008100;008006040090040020003000000400500000020061397301700054702039000050004000000000010;140075003302000008000000594085001000201004005000000000470069050003200600000080000;500000060102090804603000709008300200400205900200010600300000507007001080040000020;000001600270600004300500090500004100000100007000706859010009040420008000600007205;684300000000900000003601000100004630060000240040070008802060004005400080006005710;030500020100000060020708300904000000005430600200810904000000806002080703350090000;040002060073080000050000700609015000000004002000079600001408020000063000064027080;000100400074300051890004000005271000060000530000030019400000060080700003310400002;006020701400003000009010060000008007080002600017650008002540380700006210000000005;910003200000020008004501067700050893000000600001200004020840750005300000000010006;007000003900843015000000060700500300005204001291000800600000500000450008000031046;021000000000003000000690007002076003980000000007025481003507000040009030006040958;700900061261007000500020000009060400000000300020810500082075000000008620000000875;040000003608090010920040085000450000060008000035901240000300000300080060100000937;050000009800001000700800000285070600001080000630105040004600050002534000010700460;009001004060050090407060120000500000105080000920000078000678003084900000003000800;010000580200000007000070014000080000709060021080509000376010400000697105000008070;928306100050800030306004000100008060000100903080000201030900500000720600609000000;040300000200006104063070900008001006900400500000005078309000080710630000600000053;900006380007000040000408090032014000000000053000700600806109000015007900000860037;094010000000000897000000104000000900208700400010040006029100043000009780001583200;890500000615900700204130000000000000087601000000803409000000502002040680000209070;400000301600508000200400060000003509057610200902000000001000056700006000069002830;930060000000004009000030568000090720650000841002000000170002304280040090000800200;001705302600090004009000067002300700100000000400256000000970001000000006020001000;005000700820400300600000010000000008102503600304600051090148060000050400400070020;100020600042930070000000080009043000250800000300000298900600000506300007021780000;005000070000840300009070002156798200070060050000000001400000600010400928030600400;030920000218000009047000053000053040050060000000270010000700000480300000670012005;010800003004000000000039010103056000008002406009008700000260095050900100000010327;200009000000000001060001300054703908073000000010500007040092086008100240700004000;000602100580009020003000500008090300250300010010007000000043000005981006002070403;063000401000001090701080260000000087200017006100090002305100000907064000600002000;000050040091420630007903001004380910008610005070000000000006000000039000080002390;070081509000035006304000100008100400400800010000320007081092050000500090090000001;100000039406000000009207008090030050600501740010400900020800000005070300060049800;005718000860200510701090000100300790000080000078000450083001000010000020000850009;701500006000000000602190007900000130000080069800059004070018450000200000009460000;000000004600053002900701000085000000000007060106005090500476210000000307740030506;040000030010038000000005200000600479000820060005400003001090780000316902906000005;050000308007039200000000104600083900809040000000000807020600001506010080400057000;301500800500310000960000030693705000000000060170020000000000017056170003000900025;300040750150000000067030080700090200090300075004502006000000000970000003620003019;000010090020006800057000100000068020082004500049050007210040670300020009004007000;000005000280000700030780006004001080000400692790008030020000170070053008001079000;050820006200700000094050000000002070000403000016080300079005000041930080000018700;043105000170000200020000400000500060000480070700062810007600903094700000006090008;009865300803000200700200010000009000000302080008716420300000000590001806000000701;203000040040000029001264700800100000000570000300020490090007030600010905004000086;020000500006080007097010820900050430053800090100200080000506078005000100080009000;702000080001002030005608010400791200070400009000003000010000000004860003000005046;000080007009370000007001085030960040000043800400800000003700506050004170000005204;800904000910008230070020000700013000042870109500000003600200007000060540009000060;470090000805000076630000401000100360203007000500000200000300710050004003048001020;080000090500106200002000000039000601045060030000090540470010000050200078020900400;600070080810000700400009031900000056350600100102000800293050604000700000000040000;000608210900000040807030000008009003000000500302170009700204050000067090604980000;007000000008009500040032000015060040600080300003047000970800060050000807080100905;000058074000902800005700923600007000540100000003800600000000060012300000380200040;800003050020700000000000129006005004000000910400391000034062000195004360000000070;005004000000001407410582600020040090000000008086700000802000061060410000001000974;620300001309800002080007050463010000000400000502000010000902030207506000006000805;000004007097006200000908000042300050010000800705000000620000900008027003100800060;000700005024000100000080600010205000000190400032840510060008003300000200007052080;000020600030900480002000001800700005760002140300059000400000016080400000206380090;001069780040080006009050010100035600000020870000400000090001008500000000800002560;000513020000870010000020000006350200503090704802400300000140000270000009005030800;025000010000020003894000250007003068600007132200000000000060370002900004009008500;000906000900050060000000740006075900051600200800100005109000000068003401540090000;050601000804309200003207004409000087500006000000010009000020000030065800200000045;700003200300250100600900040050096728060000000002005091047000910008300000000010004;000860000500007001607010200003478000000930007400001960040020070000004096300005400;203900640068500092000000000015000000006380000934200060070093800000002005001800009;580000096900560004000204300100000002270030649090700100000020460019000000000086000;060000090004700530970108006130070069006000004000001007000046000007030100005010082;000502307000000094400380102002106409091000003008090000920050008006003000050004000;100803670000410000070000000000930080927500103060200095200040000080000047000068300;080072000000098001600000000050001046200003090803500007031250970900030050002007000;400060050070005040500400700300008106009046800010300004003572000005030009000601000;070300000600009000540007000000034920002068700800071000001006250000000070200040839;032090000090000802000080300050207100000001539000000004900403001405020080020058400;060070380000058209002030000000700050006000093500304620020080970810090000000003006;003875020000000000405103860690000000084060301000004080006709005020000030000000608;070040006100006005869703000000400080700008510006010307005000002640100008000605000;907800000000010030000600090100008000600730120702500608040009000006180900050000002";
const easyPuzzlesString = "070000043040009610800634900094052000358460020000800530080070091902100005007040802;301086504046521070500000001400800002080347900009050038004090200008734090007208103;008317000004205109000040070327160904901450000045700800030001060872604000416070080;561092730020780090900005046600000427010070003073000819035900670700103080000000050;800134902041096080005070010008605000406310009023040860500709000010080040000401006;165293004000001632023060090009175000500900018002030049098000006000000950000429381;000003610000015007000008090086000700030800100500120309005060904060900530403701008;960405100020060504001703006100004000490130050002007601209006038070218905600079000;904520070001890240002643000070960380000108700600000010090080000000750030000312569;001408006093520741000010520602080300007060000005039060064052109020000654500607083;007300054245080900003040070070960000000020760000801002008294016609108020000007003;005346170000000050000800009502930741070000003000700020090050632207600400600420007;320090400705021800001060372218037009500480700000005000670000280000873900804000107;000030007480960501063570820009610203350097006000005094000000005804706910001040070;087002010204017003006800705508001000640008100002050670439180007020900030700023091;040000008760020349000470500900000030000036702308947000000004010200700603690001000;007009050040000930059740080000016790083000002710000000830060020000395018605020070;620740100070100052508000370067300900090000060800970031002000006000800000450002003;700000000400708061100296847000001400801000030090600075080010006007052394935467010;900000002010060390083900100804095007130670049060041000302010050000500000541080030;005000060000006302040081597012038754000200810087014000120007680000092030954860200;709000100421000050300700008100000302908320000002070809070530400090000675000600093;001300002079000000020670903000967300750001049080503100040702530205806700107405060;600017400401003008059800721120000050000040800008020100004530007700090086263170000;800005047040008500000000630000000490590040002072006305980000273067804051030070000;400000070060850240000301065049078500007032008280009430120703004700010000006200009;500000260024086000807152300000600703003400006700098120030800600072000481000070000;604001035003450001521900000069807104250014007410090006000060010000039070070140503;080000090090502000003001408007090630000000001650020000900300080310040970002879013;000000065004056701070813940006005490500690000009042000062504179000000030000000628;290800300000000046786500200020000100100009482647000903875200004310645700009008000;180023000942500008060010092209840000608395040300067850806000027407002900001700004;908260351500094872002010409003000084154083007020000905760100040009006000001005090;070620509029400000680570000300000000806750093000086005000000170064030000005004032;870500060010000207640180509000001000120006075008072006000605008000004000904008621;032104070500300002000625000080061020007402608201780054640000030098003700723056001;000001000003006097061037500000709800830040001000020006740008610300060052000900003;001002003004000900296015048560008197009000054700950300400187600010500402900020005;003060005792051400006200009268719054030026978000000601050103090029004000800002003;000009038000005004350700091000400000407500020060020805500900006840001070036040009;604300090210079064905014270450003900000001000008000000032700080890206010506000000;591300200004062031000917508063005080100480003057000000000090610048270395000050870;309000050007003060081407200108900020700340910932068000004080090506704000003020607;100000809950018000300000076580906000003500000204700560000000081600004003830169045;000000000084500970291000008809100500753942060010000000002714000370080400100035700;001090000009080054080576900076925301130000007495700080608250070000000006943607020;690538072080000600030907085040000900006029051000751800904000010008610090003000740;100500007090830004800200100400010072000048351001302006204900715315007690000000023;072834069045020008000075020014080000867040003200300800523408000000003080486007310;037604250200300100009250008000700090902005031740130006090070604001060000526800903;000000840090207100017568903700000600040602000003000002030850271900036500001700006;000000048300100720840000003003002006017060200620580304000013402100600890004857001;580062041060901000009000600006107839720008010001000006000705000075406003648039150;140000270070054319500207048000068024080400107024730000007000802802003400491806000;010000608900000100706300000500743000000005400340091075003200091104000300069000050;380500091697010005005080700460200003073098140800743000140000907730904000950070030;000050780000600010090020603100400000054260090007030001582910370000002500003000129;750314600830006001010000407507208000400000059000950084300000070081000003002001800;000070060200486010080032000400800030000047002600213740831054000527000000960020570;000534007000297500020016004000008000058409070000000600500000010900641850183700946;709000040032640059080279106000320000290001308013000020076100200000804003500002091;050600041003045600960800300600000100007008204402000003029500036006024510000000802;000090015000100840050380207000530000000602431012009500028003004037000002400050083;000000145903405700005000900092070000031502000600008500080009357700800600006007090;092405000007000250010800000746000309009060802100009067901030000600080900084590001;002085700000607000000100000400001007267504000001000090518700430030010506900003001;802604050000001064004005003900107430508390601317046020400063708080000000000000506;100305098090000000080179602624000000800607420370040800068004930030008060005006204;600083570300700900000069030000001008100630400503090010840302009032040085000058000;000006900000020874528000360035081000000073185070064209002040008019008403700002006;020030108500970020800002003740605300005087602060410800004090560009800204150260000;009630080081000023200580074000103809000408002000200460050900030070804290802010046;005400890000037254410809030200370569501900000790000008020004900640790103050010000;098100063060040000702500010400058030015000080306010000600005040927000300000206007;000002534000010280200034000020000740906000300140203000708000001300009600460070803;190406300523090700060300000000140257300560000040700600009000000401008902000007036;900002050002905004075340200097063405050000126080000973500607390000400502320001007;159080070240790001000000004300008000080070143092000005900100460507840300001007050;036704100007632000094500000000100034069807512000053000920000006050208001470300050;170504069009000005546091300680070020930100640700209500000006004000700096408002750;360000209800309005090012076000000002080090610603041800026580031100000000500020908;080026005000000623020940170050092081708400002090000040075634200260080030903007806;201006500000500800087300960000603704020009000400102398005060239093270081002001005;450029030139480050802300009504008090008500047070614008705000200200860900000070080;000008601400706850050003040005020004146580000003004905061805492020900076097600010;090060085180002369360900000050040008000009004074200050000736590700000000509000073;704930008008607000039000400070000600400500032000023709800200300206308175013700204;570203001903004085041000300700000190000098000219007030054806070002970010090020053;600000701010079603273801000800750002007018000021040008180025300030004060400307200;603000002709400300000000940210050890308027654060800701804001000500009438000300010;503004008008900605000570041130700006020600003406103000950017062001025030000896504;070940320200675009050008406843152000062407081000809004090200000000080060305000140;300007000009006710600004359702010098530409007001000000168000200900030580050000971;100780005030049120009300478850000000306904802000063040900420050400000000620038094;010000340920683050030714000052060001000001003000400079186592000049130006000046000;008603019305200000000007603501000000604000080890400052000750001000002004402006735;800100507070906001231405896008040760704012008000700015507601000910800004603000000;000000094041003000920060030030059006100200749298004300060300002002096150000042000;360400050401600070000057004030024019000009006010000023006008237290040601000000090;060004108081200050702000069050020900246107085973680000027050000300740002000800090;050843002800001000000965783000008924040106530090204018024007090086000270570600300;000003090010200700700000030090028047400190026120000589082000000900012654001006270;804005109090060074007100560400900800059080640010000032000000080030500016005070093;700908000600530000900100080204300000070060503030700020095402008480090152302815079;021374800740180002000026070230000500058000024900540008400008013096030005300450080;100700005470028060285003090002000034004060700300250016000000000020400371741900000;613040027000000000094000065200000030009607054000009600706300010000500006082164570;080500000016700005000000709109073408005829070078100030002005107000007080001068593;000080036002010050400509180020870600000090070076005010210708000045063729037000000;000854900030679100040010060000140600004068012102005008800000007000027000203000501;002608000008900420004100009703010060600020500820004100010050908250481370480793201;000000040431000800897004020062400300040293010500007092000001200000020074080570930;023901006941005732685023010000200078290000001104008000007580600450006003800300000;108036907000810304004509000200740680400000000000058002950180200007900801012004000;000105006160800900390700501001907805050380060080000003070008659000000400008509207;872000060100762080630900010040003520500004601310006007400207803001050000050040070;005890603060403000030050010500038100003009000190570000000042008850010409070905020;001070040700400038003000067004037020908024070307080050009008200006213090100056083;306700451000201006700000002290140005801000000435000109670000000043000900500003060;020090004641000037070000002500040021030780509006003000000000410000030096460200075;670000040300000000001065000807300090460000030009478201100000023706080054000910700;300006205052300000984000607840001579020058043000700060500403001270000000009502000;300000070002306010600890003000209560000570100500610934004000090006080701805001206;600730800025481006701000000490057001260000000510364098100540000030029407050876020;560000003008690000092045007040002080010409020270000496400000500089510002657008000;009001070143907208760824093030000001097410300620008000804065009306000000000080040;000063470600040891004080003720614059415030000096270004940000000060000745807001000;004001200790400100031905784003610005062307000000002000300050040020094061006030000;007000200310705406600040100000430527200607900000800010700004000190500860003080740;070586000000700530000140000809257100001000020560831074007000400000408359080029006;042639005300071600069208403034000000001000347000500100403015869596080000010062030;300905074090008001608004050764000019030009087000100430247590068000780000016000005;000000000300750960000800541030070100070490385045103600103245790000960013029001050;963710000000040903000000670502000030000050009007308154370200000209801300040030098;800000600326070000041090038408960572060701940970000186000400300002030860504010020;400051000573062900000000507800009153130600804000003000926800430054090208000024609;109805020640109750285040691800000000756010004000200000090081000007306800300402019;208035009050400603000179802090000000506814007704093060007001006000700080460000021;080000051004089030020406900108002000007810523000070080703021845050008002812300600;630502100400000736900070405290800004001000200500200003109005870000000000050029000;985000000400008610000025049100300462096500000040010007028450000000690070619802534;040017008892603107001098300100009850358024060009180000910000030087500019030040000;746000009308400070129600000000000002932000617004010090090080004607094203400200060;010307805305009740004080030047010003000003400100058206009031000038000900201806050;043927681010030920000408000724090006035000007900000030471000060050600019060070300;000701053040005010000800200530108000962504000000209340406000009103000520200000634;600930000000005306200008491100003904803600700924087560407500030302890605000070208;003005264609802000010000900096000730180600095000050000960030000005080019030209546;020000100050000080800435006600927400002000007907040021000298000290061040178000902;940260380037001900650800001360020000175000203028013000200005037710086592090002000;240069010000050000697431852020100086500940007000006520300014065010093270050000001;005000920800000500072050004006004285000060001009018306090001058008593000650802000;210403709040006030007918000401830076003160890026097040300000900579040200084000050;000302000600000508405000030079006004002800607850017000900703480000140900200069300;001320050620000430008004062103090070780461293042080000030070000007240300000130040;060090504100065208070082690002057040500230080097806325080020900600009000003670002;537008000600709800040350006376100020008520300254603090000010000105070680460830700;008060230020000009647209105405020608102000074060700000006002800000070901030408720;000978200300050498200043715680300000003800600020007309100709056800005137700100040;286000013010000506300060800030704065000000000000510900001080407040256000009401032;500032810000087000870450902900245000050090473408100209000060328082010095000008004;800106300030008200001000084000307040010002809762804005000080713380901400176000908;000000040659084120000910000073620900800000356000835207260048000030090468904000500;702004598000800071001790004004006050000000869098003007040058702000030000010200930;126000735000100000700003104010730409943000672005906000302000001001800007007010246;000058000063000289200030107007600400840012090000000700602001904930000072000000015;908200070200001695761000800097100500000000010000000402600415080304002150002730040;805700409000690058409020760003080270600079003000102006570940630390200004000058910;079005006000020040263070105000000002090000638835000004000702800081450203307600059;000170068000000000001003009020835010050010243003020900302069004500201076087304002;094801730007450629500907408005000004140000200003105890020304061386000000001090300;405381002017500830802070001100000078780940000003000050071806009900027005528409000;978543612526071003000200009600019005190650204000000000357094000000000030004700090;051600700069703852800905400580000027000250300320000600900000000600408230700506080;000000678410060002063000000001005200000810050070240010187409000900001005304672009;000071980790385100150029637000930000079500804000807009060104050000700013017000400;080020306071006000300000000804050000000004205052100647509800700603000000048302090;960308520750000000803260700074100000020036000305482170519040260080000000000520008;503704920070000060000060800020098070608400003000623590001049030006001709009870104;024786000006502407708000009875960102003004005000107000000630950530070026080210730;000000080019000002025780341970358000180097003050006009340070005061005428000004600;470139680008250400009040000900074001030000900000091006005760040604023100000000208;200019500000083970900740810072064090049025600018007040000930460000001000094000050;600000305075903001120050900851004290009380000007002400706040009002100060930060050;920006400010980007007020009052170003100002705700453020070001800300069502509047306;000230600859001000362504800080020946000046000046180000608402105520600070000853402;450908276000005000000076084010050600000097030009600058035009801108320000064000300;030000060600034059000020408700406210000201080009070006007100604180040075905000000;000010258001007030042030107593472600008000003106080040039000002010500000705060390;090054037050000601103209580001002070000510000084070160715600009000301006320090418;768400300190032007250068009010600000940025180600901705021050070070103000009270000;020900003605000902000060504200010040004300010096470025907026401000093857000700096;100070983050006074302900000500637490040501302030004010790002845200489000480700000;082050900570040100006010000820194300000730008060005010758300090000409002090500007;503621007009050102008009046095170064000802000217000900000000610730000400450006000;900470836020080009008900000482000960070109208006200075051300090207000503600010782;700000009598370021601090700004005300070429000080000060007200005420700010000961270;804036751600200308000008060050729000003054000009300475912000000500090107307085924;700250000548900010026047000200600403380075020460012070870030594054000001030000267;570140900001056307000080405009405180010809000600000209060000801000698700084007690";

let puzzles = hardPuzzlesString.split(";");
let puzzle = null;

let undoStack = [];
let redoStack = [];

const noSleep = new NoSleep();

let wakeLockEnabled = false;
const toggleEl = $("#toggle");
toggleEl[0].addEventListener('click', function() {
    if (!wakeLockEnabled) {
        noSleep.enable(); // keep the screen on!
        wakeLockEnabled = true;
        toggleEl.removeClass("unselected");
    } else {
        noSleep.disable(); // let the screen turn off.
        wakeLockEnabled = false;
        toggleEl.addClass("unselected");
    }
}, false);

loadLastState();

function level(easy) {
    if (easy) {
        $("#easy").removeClass("unselected");
        $("#hard").addClass("unselected");
        puzzles = easyPuzzlesString.split(";");
    } else {
        $("#hard").removeClass("unselected");
        $("#easy").addClass("unselected");
        puzzles = hardPuzzlesString.split(";");
    }

    newGame();
}

function mode(v) {
    $('#numberbuttons').hide();
    $('#markbuttons').hide();
    $('#centerbuttons').hide();
    $('#colorbuttons').hide();
    
    $('#numbers').addClass("unselected");
    $('#mark').addClass("unselected");
    $('#center').addClass("unselected");
    $('#color').addClass("unselected");

    switch (v) {
        case 1:
            $('#numberbuttons').show();
            $('#numbers').removeClass("unselected");
            break;
        case 2:
            $('#markbuttons').show();
            $('#mark').removeClass("unselected");
            break;
        case 3:
            $('#centerbuttons').show();
            $('#center').removeClass("unselected");
            break;
        case 4:
            $('#colorbuttons').show();
            $('#color').removeClass("unselected");
    }
}

function newGame() {
    let randomPuzzleIndex = Math.floor(Math.random() * (puzzles.length + 1));
    puzzle = puzzles[randomPuzzleIndex];
    resetGame();
}

function resetGame() {
    let counter = 0;
    $("#board").empty();
    for (let r=1; r < 10; r++) {
        const row = document.createElement("div");
        $(row).attr("class", "row R" + r);
        for (let c=1; c < 10; c++) {
            const cell = document.createElement("div");
            $(cell).attr("id", "C" + r + c).attr("class", "cell C" + c);
            const div = document.createElement("div");
            $(div).addClass("number");
            $(cell).append(div);
            if (puzzle[counter] != "0") {
                $(div).append(puzzle[counter]);
                $(cell).addClass("fix");
            }
            $(cell).append("<div class='m'></div");
            $(cell).append("<div class='c'></div");
            $(cell).append("<div class='border'></div");
            $(row).append(cell);
            counter++;
        }
        $("#board").append(row);
    }
    initCellClickHandlers();
    undoStack = [];
    redoStack = [];
}

function initCellClickHandlers() {
    for (let r=1; r < 10; r++) {
        for (let c=1; c < 10; c++) {
            const cell = $("#C" + r + "" + c);
            $(cell).click(function(e) {
                cellClicked(e, r, c);
            });
            $(cell).dblclick(function(e) {
                cellDblClicked(e, r, c);
            });
        }
    }
}

function check() {
    $(".error").removeClass("error");

    let counter = 0;

    //rows
    for (let r = 1; r < 10; r++) {
        const numbers = [];
        for (let c = 1; c < 10; c++) {
            if (!checkCell(numbers, r, c)) {
                return;
            }
            if (!cellIsNull(r,c)) {
                counter++;    
            };
        }
    }

    //columns
    for (let c = 1; c < 10; c++) {
        const numbers = [];
        for (let r = 1; r < 10; r++) {
            if (!checkCell(numbers, r, c)) {
                return;
            }          
        }
    }

    //sections
    for (let sr = 0; sr < 3; sr++) {
        for (let sc = 0; sc < 3; sc++) {
            const numbers = [];
            for (let r = sr * 3 + 1; r < sr * 3 + 4; r++) {
                for (let c = sc * 3 + 1; c < sc * 3 + 4; c++) {
                    if (!checkCell(numbers, r, c)) {
                        return;
                    }
                }
            }
        }
    }

    if (counter == 81) {
        showInfo("Sudoku gelÃ¶st!");
        return;
    }

    showInfo("Keine Fehler gefunden")
}

function cellIsNull(r, c) {
    const cell = $("#C" + r + "" + c);
    const value = $(cell).find(".number").html();
    return value.length < 1;
}

function checkCell(numbers, r, c) {
    const cell = $("#C" + r + "" + c);
    const value = $(cell).find(".number").html();
    if (value.length > 0) {
        if (numbers.indexOf(value) >= 0) {
            $("#board").find('.R' + r).find(".C" + c).removeClass("selected").addClass("error");
            showInfo("Doppelte Zahl " + value + " an Stelle " + r + " / " + c);
            return false;
        }
        numbers.push(value);
    }
    return true;
}

function addUndoEntry() {
    undoStack.push( getState());    
    $("#undobutton").removeClass("disabled");
}

function addRedoEntry() {
    redoStack.push(getState());
    $("#redobutton").removeClass("disabled");
}

function getState() {
    return $("#board").html();
}

function setState(s) {
    $("#board").html(s);
    initCellClickHandlers();
}

function setLastState() {
    localStorage.setItem('lastState', state);
}

function loadLastState() {
    const state = localStorage.getItem('lastState');
    if (state == null) {
        newGame();
    } else {
        setState(state);
    }
}

function undo() {
    if (undoStack.length > 0) {
        addRedoEntry();
        setState(undoStack.pop());
    }
    if (undoStack.length == 0) {
        $("#undobutton").addClass("disabled");
    }
}

function redo() {
    if (redoStack.length > 0) {
        addUndoEntry();
        setState(redoStack.pop());
    }
    if (redoStack.length == 0) {
        $("#redobutton").addClass("disabled");
    }
}

function buttonClicked(number) {
    if (!$('#highlight').hasClass('unselected')) {
        highlight(number);
        return;
    }

    if ($(".cell.selected").not(".fix").length == 0) {
        return;
    }
    
    addUndoEntry();

    $(".cell.selected").not(".fix").each(function(){
        $(this).find(".number").html(number == 0 ? "" : number);
        $(this).find(".m").html("");
        $(this).find(".c").html("");
    });

    setLastState();
}

function markButtonClicked(number) {  
    if (!$('#highlight').hasClass('unselected')) {
        highlight(number);
        return;
    }

    if (number == 0) {
        $(".markbutton.selected").removeClass("selected");
        $(".cell.selected").not(".fix").find(".m").html("");
        return;
    } else {
        $("#markbutton" + number).toggleClass("selected");
    }

    if ($(".cell.selected").length == 0) {
        return;
    }

    addUndoEntry();

    $(".cell.selected").not(".fix").each(function(){
        let marks = $(this).find(".m").html();
        if (marks.indexOf(number.toString()) == -1) {
            marks += number.toString();
        } else {
            marks = marks.replaceAll(number.toString(), "");
        }

        //sort alphabetically
        if (marks.length > 0) {
            marks = marks.split('').sort().join('');
        }

        $(this).find(".m").html(marks);
    });

    setLastState();
}

function centerButtonClicked(number) {   
    if (!$('#highlight').hasClass('unselected')) {
        highlight(number);
        return;
    }

    if (number == 0) {
        $(".centerbutton.selected").removeClass("selected");
        $(".cell.selected").not(".fix").find(".c").html("");
        return;
    } else {
        $("#centerbutton" + number).toggleClass("selected");
    }

    if ($(".cell.selected").length == 0) {
        return;
    }

    addUndoEntry();

    $(".cell.selected").not(".fix").each(function(){
        let marks = $(this).find(".c").html();
        if (marks.indexOf(number.toString()) == -1) {
            marks += number.toString();
        } else {
            marks = marks.replaceAll(number.toString(), "");
        }

        //sort alphabetically
        if (marks.length > 0) {
            marks = marks.split('').sort().join('');
        }

        $(this).find(".c").html(marks);
    });

    setLastState();
}

function colorButtonClicked(cssClass) {
    if ($(".cell.selected").length == 0) {
        return;
    }

    addUndoEntry();

    $(".cell.selected").removeClass("red green blue yellow grey");
    $(".cell.selected").addClass(cssClass);

    $('.colorbutton').removeClass("selected");
    $('.colorbutton.' + cssClass).addClass("selected");

    setLastState();
}

function cellClicked(e, r, c) {
    const cell = $("#C" + r + "" + c);
    const multiple = e.ctrlKey || !$("#multiple").hasClass("unselected");

    if ($(cell).hasClass("selected")) {
        $(cell).removeClass("selected");

        if (!multiple) {
            $(".cell.selected").removeClass("selected");
        }  

        return;
    }

    if (!multiple) {
        $(".cell.selected").removeClass("selected");
    }    

    if (!$(cell).hasClass("fix")) {
        $(cell).addClass("selected");
        initMarks(cell);
    }  
}

function cellDblClicked(e, r, c) {
    const cell = $("#C" + r + "" + c);
    if ($(cell).find(".number").html().length == 1) {
        const n = $(cell).find(".number").html();
        highlight(n);
    }
}

function initMarks(cell) {  
    $(".markbutton").removeClass("selected");
    $(".centerbutton").removeClass("selected");
    $(".colorbutton").removeClass("selected");

    if (cell == null) return;

    const marks = $(cell).find(".m").html();
    for (let i = 1; i < 10; i++) {
        if (marks.indexOf(i.toString()) > -1) {
            $("#markbutton" + i).addClass("selected");
        }
    }

    const center = $(cell).find(".c").html();
    for (let i = 1; i < 10; i++) {
        if (center.indexOf(i.toString()) > -1) {
            $("#centerbutton" + i).addClass("selected");
        }
    }

    if ($(cell).hasClass("red")) {
        $(".colorbutton.red").addClass("selected");
    }
    if ($(cell).hasClass("green")) {
        $(".colorbutton.green").addClass("selected");
    }
    if ($(cell).hasClass("blue")) {
        $(".colorbutton.blue").addClass("selected");
    }
    if ($(cell).hasClass("yellow")) {
        $(".colorbutton.yellow").addClass("selected");
    }
    if ($(cell).hasClass("grey")) {
        $(".colorbutton.grey").addClass("selected");
    }
}

function highlight(number) {
    $('.highlighted').removeClass("highlighted");

    $('.cell').each(function(){
        if ($(this).find(".number").text().indexOf(number.toString()) > -1) {
            $(this).addClass("highlighted");
        }
    });
}

function showInfo(text) {
    $('#infotext').text(text);
    $('#infomessage').show();
}

function numberKeyClicked(number) {
    if (!$('#numbers').hasClass("unselected")) {
        buttonClicked(number);
    }
    if (!$('#center').hasClass("unselected")) {
        centerButtonClicked(number);
    }
    if (!$('#mark').hasClass("unselected")) {
        markButtonClicked(number);
    }
}

function move(direction)
{
    if ($(".cell.selected").length != 1) {
        return;
    }

    const cell =  $(".cell.selected").first();

    const r = $(cell).closest(".row").index();
    const c = $(cell).index();

    let newCell = null;

    if (direction == 1) { //up
        if (r > 0) {
            newCell = $('.R' + r).find(".C" + (c + 1))            
        }
    }

    if (direction == 2) { //down
        if (r < 8) {
            newCell = $('.R' + (r + 2)).find(".C" + (c + 1));
        }
    }

    if (direction == 3) { //left
        if (c > 0) {
            newCell = $('.R' + (r + 1)).find(".C" + (c));
        }
    }

    if (direction == 4) { //right
        if (c < 8) {
            newCell = $('.R' + (r + 1)).find(".C" + (c + 2));
        }
    }

    if (newCell != null) {
        $(cell).removeClass("selected");
        newCell.addClass("selected");
    }

    initMarks(newCell);
}

$(document).keyup(function(event) {
    switch (event.keyCode) {
        case 87:
            redo();
            break;
        case 82:
            undo();
            break;
        case 37:
            move(3);
            break;
        case 38:
            move(1);
            break;
        case 39:
            move(4);
            break;
        case 40:
            move(2);
            break;
        case 48:
            numberKeyClicked(0);
            break;
        case 49:
            numberKeyClicked(1);
            break;
        case 50:
            numberKeyClicked(2);
            break;
        case 51:
            numberKeyClicked(3);
            break;
        case 52:
            numberKeyClicked(4);
            break;
        case 53:
            numberKeyClicked(5);
            break;
        case 54:
            numberKeyClicked(6);
            break;
        case 55:
            numberKeyClicked(7);
            break;
        case 56:
            numberKeyClicked(8);
            break;
        case 57:
            numberKeyClicked(9);
            break;
        case 90:
            mode(1);
            break;
        case 65:
            mode(2);
            break;
        case 70:
            mode(4);
            break;
        case 73:
            mode(3);
            break;
        case 109:
            $('#multiple').toggleClass('unselected');
            break;
        case 98:
            $('#toggle').click();
            break;
        case 99:
            check();
            break;
        case 13: //ENTER
            if ($('#infomessage').is(":visible")) {
                $('#infomessage').hide(); 
            }
            break;
        default:
            //alert('Handler for .keyup() called. - ' + event.keyCode);
    }
});